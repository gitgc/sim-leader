# HTTP Mode Caddyfile - For development/testing
# No HTTPS, simple HTTP reverse proxy
{
  auto_https off
}

http://localhost {
  reverse_proxy app:3001

  @static path *.css *.js *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2 *.ttf *.eot
  header @static Cache-Control "public, max-age=86400"

  header {
    # Remove server info
    -Server

    # Security headers
    X-Content-Type-Options nosniff
    X-Frame-Options DENY
    X-XSS-Protection "1; mode=block"
    Referrer-Policy strict-origin-when-cross-origin
  }

  encode gzip

  log {
    output file /var/log/caddy/access.log {
      roll_size 10MB
      roll_keep 14
      roll_keep_for 720h
    }
    format json
    level INFO
  }
}